{"componentChunkName":"component---src-templates-lesson-template-js","path":"/webserver/simple","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p>Make sure you are on the <a href=\"https://github.com/burkeholland/deno-exercises/tree/6-building-a-simple-webserver\">6-building-a-simple-webserver</a> branch to follow along with this section.</p>\n</blockquote>\n<p>One of the most common use-cases for a JavaScript runtime is a web server. Web servers are a common way of exposing APIs and building full stack data-driven applications.</p>\n<p>The Deno standard library contains a <code class=\"language-text\">server</code> module that lets you implement in a web server in just a few lines of code.</p>\n<p>First, import the <code class=\"language-text\">server</code> module from the Deno standard library into the \"app.ts\" file.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> serve <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"https://deno.land/std/http/server.ts\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Next, we'll, define <code class=\"language-text\">HOSTNAME</code> and <code class=\"language-text\">PORT</code> constants. For the <code class=\"language-text\">HOSTNAME</code>, we'll use 0.0.0.0, which is the same as saying \"localhost\" or \"127.0.0.1\", but is more compatible with things like Docker.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> serve <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"https://deno.land/std/http/server.ts\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">HOSTNAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The only thing you need from the <code class=\"language-text\">server</code> library is the <code class=\"language-text\">serve</code> function. All you need to do is call that function and pass in the hostname and port to get a new server instance.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> serve <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"https://deno.land/std/http/server.ts\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">HOSTNAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token function\">serve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> hostname<span class=\"token operator\">:</span> <span class=\"token constant\">HOSTNAME</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">:</span> <span class=\"token constant\">PORT</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The server has been created, but it doesn't do anything because we aren't handling the requests. As awkward as this may seem, we're going to run an infinite <code class=\"language-text\">for</code> loop and handle any request that comes in by setting the <code class=\"language-text\">respond</code> property on the request.</p>\n<p>Use a <code class=\"language-text\">for</code> loop to start the server and listen for any incoming request. The body contains a simple response of \"Hello World\".</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> serve <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"https://deno.land/std/http/server.ts\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">HOSTNAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token function\">serve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> hostname<span class=\"token operator\">:</span> <span class=\"token constant\">HOSTNAME</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">:</span> <span class=\"token constant\">PORT</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Server is now running on: http://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">HOSTNAME</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token keyword\">await</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> req <span class=\"token keyword\">of</span> server<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  req<span class=\"token punctuation\">.</span><span class=\"token function\">respond</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    body<span class=\"token operator\">:</span> <span class=\"token string\">\"Hello World\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Run the program with <code class=\"language-text\">deno run app.ts</code>. It should tell you that permission is denied and that the <code class=\"language-text\">allow-net</code> flag is required.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Check file:///home/burkeholland/dev/deno-first-look-exercises/app.ts\nerror: Uncaught PermissionDenied: network access to <span class=\"token string\">\"0.0.0.0:3000\"</span>, run again with the --allow-net flag</code></pre></div>\n<p>Run the program again with the <code class=\"language-text\">--allow-net</code> flag. Be sure to restrict the access to only port 3000.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">deno run --allow-net<span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0:3000 app.ts</code></pre></div>\n<p>The server should now be running on port 3000. When you visit it in the browser, you should see \"Hello World\".</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/deno-first-look/static/24d73228a2be32bdc5c80ac8a198e616/ee269/simple-web-server.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDAREAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMEBQn/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHd0kCi8AD/xAAZEAACAwEAAAAAAAAAAAAAAAAABAIFFSD/2gAIAQEAAQUCjXLmeiZlfx//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AV//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAlEAAABAILAQAAAAAAAAAAAAABAgMRAAQSICEjJDEzNFGT0dL/2gAIAQEABj8CvSJrsDFBRBBi8iFFMM42cr0J/MDgpa0X0SeVP//EABsQAQADAAMBAAAAAAAAAAAAAAERIUEAIDFh/9oACAEBAAE/IZAg+8oiGGsvMAAjjIGWolbo1wV4QfOn/9oADAMBAAIAAwAAABCAAD//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EF//xAAYEQACAwAAAAAAAAAAAAAAAABx8AEgMf/aAAgBAgEBPxBTpm3/xAAZEAEBAQEBAQAAAAAAAAAAAAABETEAECH/2gAIAQEAAT8QLmo9Ixag4GAOKCafO6QMstFiJkAE2UCt9//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Simple web server returning hello world\"\n        title=\"Simple web server returning hello world\"\n        src=\"/deno-first-look/static/24d73228a2be32bdc5c80ac8a198e616/a24e6/simple-web-server.jpg\"\n        srcset=\"/deno-first-look/static/24d73228a2be32bdc5c80ac8a198e616/a6b4f/simple-web-server.jpg 200w,\n/deno-first-look/static/24d73228a2be32bdc5c80ac8a198e616/a6407/simple-web-server.jpg 400w,\n/deno-first-look/static/24d73228a2be32bdc5c80ac8a198e616/a24e6/simple-web-server.jpg 800w,\n/deno-first-look/static/24d73228a2be32bdc5c80ac8a198e616/ee269/simple-web-server.jpg 1008w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"returning-html\" style=\"position:relative;\"><a href=\"#returning-html\" aria-label=\"returning html permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Returning HTML</h2>\n<p>Returning text isn't terribly useful, so instead, return some HTML.</p>\n<div class=\"gatsby-highlight\" data-language=\"app.ts\"><pre class=\"language-app.ts\"><code class=\"language-app.ts\">for await (const req of server) {\n    req.respond({\n      body: &quot;&lt;h1&gt;Hello World&lt;/h1&gt;&quot;,\n    });\n}</code></pre></div>\n<blockquote>\n<p>Make sure you restart the server. You can also run with the --watch flag so that the server is restarted every time you make changes.</p>\n</blockquote>\n<p>OK - that's about as simple a web server as we can get. Let's take a look at some common web server type scenarios.</p>","frontmatter":{"path":"/webserver/simple","title":"Building a simple webserver","order":"6A","section":"6 - Building a Webserver","description":"Burke looks at how to build a simple web server with Deno"}},"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"order":"4D","path":"/dependencies/best-practices","title":"Best Practices"}}},{"node":{"frontmatter":{"order":"4E","path":"/dependencies/compatibility-with-node","title":"Compatibility With Node"}}},{"node":{"frontmatter":{"order":"4B","path":"/dependencies/local-dependencies","title":"Local dependencies"}}},{"node":{"frontmatter":{"order":"4C","path":"/dependencies/remote-dependencies","title":"Remote dependencies"}}},{"node":{"frontmatter":{"order":"4A","path":"/dependencies/think-like-a-browser","title":"Thinking like a browser"}}},{"node":{"frontmatter":{"order":"8A","path":"/deploying/containerize-deno-app","title":"Containerizing a Deno Application"}}},{"node":{"frontmatter":{"order":"8C","path":"/deploying/deploy-deno-image","title":"Deploying the Deno image"}}},{"node":{"frontmatter":{"order":"8B","path":"/deploying/push-to-image-registry","title":"Pushing the Deno image to a registry"}}},{"node":{"frontmatter":{"order":"3E","path":"/getting-to-know/arguments-and-flags","title":"CLI Tour"}}},{"node":{"frontmatter":{"order":"3F","path":"/getting-to-know/debugging","title":"Debugging"}}},{"node":{"frontmatter":{"order":"3D","path":"/getting-to-know/deno-object","title":"The Deno object"}}},{"node":{"frontmatter":{"order":"3C","path":"/getting-to-know/first-program","title":"Your first program"}}},{"node":{"frontmatter":{"order":"3A","path":"/getting-to-know/install","title":"Installing Deno"}}},{"node":{"frontmatter":{"order":"3B","path":"/getting-to-know/tooling","title":"Tooling"}}},{"node":{"frontmatter":{"order":"7A","path":"/oak/introducing-oak","title":"Introducing Oak"}}},{"node":{"frontmatter":{"order":"7C","path":"/oak/oak-router","title":"The Oak Router"}}},{"node":{"frontmatter":{"order":"7D","path":"/oak/oak-templates","title":"Templates"}}},{"node":{"frontmatter":{"order":"7B","path":"/oak/simple-oak","title":"A Simple Oak Server"}}},{"node":{"frontmatter":{"order":"7E","path":"/oak/static-files","title":"Serving Static Files"}}},{"node":{"frontmatter":{"order":"5D","path":"/permissions/determining-permissions","title":"Determining Permissions"}}},{"node":{"frontmatter":{"order":"5A","path":"/permissions/granting-permissions","title":"Granting Permissions"}}},{"node":{"frontmatter":{"order":"5C","path":"/permissions/permission-specificity","title":"Permission Specificity"}}},{"node":{"frontmatter":{"order":"5B","path":"/permissions/requesting-permissions","title":"Requesting Permissions"}}},{"node":{"frontmatter":{"order":"6B","path":"/webserver/reading-parameters","title":"Reading the query string"}}},{"node":{"frontmatter":{"order":"6A","path":"/webserver/simple","title":"Building a simple webserver"}}},{"node":{"frontmatter":{"order":"6C","path":"/webserver/static-files","title":"Serving up static files"}}},{"node":{"frontmatter":{"order":"1B","path":"/exercises","title":"How to use the exercises"}}},{"node":{"frontmatter":{"order":"1A","path":"/intro","title":"Introduction"}}},{"node":{"frontmatter":{"order":"2C","path":"/what-is/dependency-hell","title":"Dependency Hell"}}},{"node":{"frontmatter":{"order":"2B","path":"/what-is/secure-by-default","title":"Secure By Default"}}},{"node":{"frontmatter":{"order":"2D","path":"/what-is/typescript-first","title":"TypeScript First"}}},{"node":{"frontmatter":{"order":"2A","path":"/what-is/why-oh-why","title":"What & Why"}}}]}},"pageContext":{}},"staticQueryHashes":["2959687377"]}